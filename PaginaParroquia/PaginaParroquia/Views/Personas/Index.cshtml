@model PagedList.IPagedList<PaginaParroquia.Models.Persona>
@using PagedList.Mvc;
@using PaginaParroquia.Models
<link href="~/Content/PagedList.css" rel="stylesheet" />

@{
    ViewBag.Title = "Personas";
    //Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Personas</h2>

@using (Html.BeginForm())
{
    <p>
        Buscar por: @Html.DropDownList("BuscarPor",
new SelectList(Enum.GetValues(typeof(BuscarPor))),"----Buscar Por----", new { @id = "selectTipo", @class = "form-control"})
        <br> @Html.TextBox("searchString", ViewBag.currentFilter as String, new { @id = "txtBuscar", @class = "form-control" }) <br />
        <input type="submit" value="Buscar" id="btnBuscar" class="btn-primary" /> @*Genera el boton de buscar*@
    </p>

}


<p>
    @Html.ActionLink("Crear Nueva Persona", "Create")

    <a href="@Url.Action("Index", "RelacionFamiliars")" style="position:relative; float: right; margin-left:104px;" class="btn btn-primary btn active" role="button" aria-pressed="true">Relaciones Familiares</a>
</p>


<table class="table">
    <tr>
        <th>
            Cedula
        </th>
        <th>
            @Html.ActionLink("Nombre", "Index", new { sortOrder = ViewBag.NameSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
            @Html.ActionLink("Apellido", "Index", new { sortOrder = ViewBag.Apellido1SortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
            @Html.ActionLink("Apellido2", "Index", new { sortOrder = ViewBag.Apellido2SortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
            @Html.ActionLink("Fecha Nacimiento", "Index", new { sortOrder = ViewBag.DateSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
            Lugar de Nacimiento
        </th>
        <th>
            @Html.ActionLink("Nacionalidad", "Index", new { sortOrder = ViewBag.NacionalidadSortParm, currentFilter = ViewBag.CurrentFilter })
        </th>
        <th>
            Estado Civil
        </th>
        <th>
            Lugar de Residencia
        </th>
        <th>
            Profesion
        </th>
        <th>
            Religion
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Cedula)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Nombre)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Apellido)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Apellido2)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Fecha_Nacimiento)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Lugar_Nacimiento)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Nacionalidad)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Estado_Civil)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Lugar_Residencia)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Profesion)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Religion)
            </td>
            <td>

                @Html.ActionLink("Edit", "Edit", new { id = item.IDPersona }) |

                @Html.ActionLink("Details", "Details", new { id = item.IDPersona }) |

                @if (User.IsInRole("Admin"))
                {
                    @Html.ActionLink("Delete", "Delete", new { id = item.IDPersona })
                }
                else
                {
                    <h9>Delete</h9>
                }

            </td>
        </tr>
    }

</table>

<br />

Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount

@Html.PagedListPager(Model, page => Url.Action("Index",
    new { page, sortOrder = ViewBag.CurrentSort, currentFilter = ViewBag.CurrentFilter }))

@section Scripts {

    @Scripts.Render("~/bundles/jqueryui")
    @Styles.Render("~/Content/cssjqryUi")


    <script type="text/javascript">
        //Encargado de ocultar el Textbox y el boton si el dropdownlist esta en el parametro predefinido
        $(document).ready(function () {
            $("#txtBuscar").attr('autocomplete', 'off');
            if ($("#selectTipo").val() === "") {
                $("#txtBuscar").hide();
                $("#btnBuscar").hide();
            }
            else if ($("#selectTipo").val() === "Fecha_Nacimiento") {

                $("#txtBuscar").show();
                $("#txtBuscar").prop('disables', true);

                $("#txtBuscar").datepicker({
                    dateFormat: "mm/dd/yy",
                    changeMonth: true,
                    changeYear: true,
                    yearRange: "-60:+0"
                });


                $("#btnBuscar").show();
            }
            else {
                $("#txtBuscar").show();
                $("#btnBuscar").show();
                $("#txtBuscar").prop('disables', false);
            }


            $("#selectTipo").change(function () {

                $("#txtBuscar").val("");
                $("#btnBuscar").click();

            });

        });
    </script>

}